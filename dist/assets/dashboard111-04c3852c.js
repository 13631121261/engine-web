import{u as ht,i as L,a as mt,b as ft,c as _t,d as gt,e as vt}from"./echarts-f501ae38.js";import{a as at,d as yt,c as wt,D as xt,F as bt,i as K,l as Ft,_ as Vt}from"./index-1515df1a.js";import{g as St,b as Et,c as Dt,d as At,e as It,f as zt}from"./index-24a0fd9a.js";import{h as Ot}from"./moment-fbc5633a.js";import{h as kt,w as f,r as Ct,az as Bt,aD as Tt,F as Nt,a6 as Lt,am as Mt,G as Yt,q as H,o as Z,k as tt,p as g,Q as v,m as a,V as _,z as d,X as Ht,Y as Pt,n as et,a0 as Ut,a1 as qt}from"./vue-974988d6.js";var P=function(){return P=Object.assign||function(u){for(var o,l=1,n=arguments.length;l<n;l++)for(var e in o=arguments[l])Object.prototype.hasOwnProperty.call(o,e)&&(u[e]=o[e]);return u},P.apply(this,arguments)},jt=function(){function u(o,l,n){var e=this;this.endVal=l,this.options=n,this.version="2.6.2",this.defaults={startVal:0,decimalPlaces:0,duration:2,useEasing:!0,useGrouping:!0,useIndianSeparators:!1,smartEasingThreshold:999,smartEasingAmount:333,separator:",",decimal:".",prefix:"",suffix:"",enableScrollSpy:!1,scrollSpyDelay:200,scrollSpyOnce:!1},this.finalEndVal=null,this.useEasing=!0,this.countDown=!1,this.error="",this.startVal=0,this.paused=!0,this.once=!1,this.count=function(h){e.startTime||(e.startTime=h);var m=h-e.startTime;e.remaining=e.duration-m,e.useEasing?e.countDown?e.frameVal=e.startVal-e.easingFn(m,0,e.startVal-e.endVal,e.duration):e.frameVal=e.easingFn(m,e.startVal,e.endVal-e.startVal,e.duration):e.frameVal=e.startVal+(e.endVal-e.startVal)*(m/e.duration);var p=e.countDown?e.frameVal<e.endVal:e.frameVal>e.endVal;e.frameVal=p?e.endVal:e.frameVal,e.frameVal=Number(e.frameVal.toFixed(e.options.decimalPlaces)),e.printValue(e.frameVal),m<e.duration?e.rAF=requestAnimationFrame(e.count):e.finalEndVal!==null?e.update(e.finalEndVal):e.options.onCompleteCallback&&e.options.onCompleteCallback()},this.formatNumber=function(h){var m,p,F,x,M=h<0?"-":"";m=Math.abs(h).toFixed(e.options.decimalPlaces);var A=(m+="").split(".");if(p=A[0],F=A.length>1?e.options.decimal+A[1]:"",e.options.useGrouping){x="";for(var O=3,I=0,V=0,z=p.length;V<z;++V)e.options.useIndianSeparators&&V===4&&(O=2,I=1),V!==0&&I%O==0&&(x=e.options.separator+x),I++,x=p[z-V-1]+x;p=x}return e.options.numerals&&e.options.numerals.length&&(p=p.replace(/[0-9]/g,function(E){return e.options.numerals[+E]}),F=F.replace(/[0-9]/g,function(E){return e.options.numerals[+E]})),M+e.options.prefix+p+F+e.options.suffix},this.easeOutExpo=function(h,m,p,F){return p*(1-Math.pow(2,-10*h/F))*1024/1023+m},this.options=P(P({},this.defaults),n),this.formattingFn=this.options.formattingFn?this.options.formattingFn:this.formatNumber,this.easingFn=this.options.easingFn?this.options.easingFn:this.easeOutExpo,this.startVal=this.validateValue(this.options.startVal),this.frameVal=this.startVal,this.endVal=this.validateValue(l),this.options.decimalPlaces=Math.max(this.options.decimalPlaces),this.resetDuration(),this.options.separator=String(this.options.separator),this.useEasing=this.options.useEasing,this.options.separator===""&&(this.options.useGrouping=!1),this.el=typeof o=="string"?document.getElementById(o):o,this.el?this.printValue(this.startVal):this.error="[CountUp] target is null or undefined",typeof window<"u"&&this.options.enableScrollSpy&&(this.error?console.error(this.error,o):(window.onScrollFns=window.onScrollFns||[],window.onScrollFns.push(function(){return e.handleScroll(e)}),window.onscroll=function(){window.onScrollFns.forEach(function(h){return h()})},this.handleScroll(this)))}return u.prototype.handleScroll=function(o){if(o&&window&&!o.once){var l=window.innerHeight+window.scrollY,n=o.el.getBoundingClientRect(),e=n.top+window.pageYOffset,h=n.top+n.height+window.pageYOffset;h<l&&h>window.scrollY&&o.paused?(o.paused=!1,setTimeout(function(){return o.start()},o.options.scrollSpyDelay),o.options.scrollSpyOnce&&(o.once=!0)):(window.scrollY>h||e>l)&&!o.paused&&o.reset()}},u.prototype.determineDirectionAndSmartEasing=function(){var o=this.finalEndVal?this.finalEndVal:this.endVal;this.countDown=this.startVal>o;var l=o-this.startVal;if(Math.abs(l)>this.options.smartEasingThreshold&&this.options.useEasing){this.finalEndVal=o;var n=this.countDown?1:-1;this.endVal=o+n*this.options.smartEasingAmount,this.duration=this.duration/2}else this.endVal=o,this.finalEndVal=null;this.finalEndVal!==null?this.useEasing=!1:this.useEasing=this.options.useEasing},u.prototype.start=function(o){this.error||(o&&(this.options.onCompleteCallback=o),this.duration>0?(this.determineDirectionAndSmartEasing(),this.paused=!1,this.rAF=requestAnimationFrame(this.count)):this.printValue(this.endVal))},u.prototype.pauseResume=function(){this.paused?(this.startTime=null,this.duration=this.remaining,this.startVal=this.frameVal,this.determineDirectionAndSmartEasing(),this.rAF=requestAnimationFrame(this.count)):cancelAnimationFrame(this.rAF),this.paused=!this.paused},u.prototype.reset=function(){cancelAnimationFrame(this.rAF),this.paused=!0,this.resetDuration(),this.startVal=this.validateValue(this.options.startVal),this.frameVal=this.startVal,this.printValue(this.startVal)},u.prototype.update=function(o){cancelAnimationFrame(this.rAF),this.startTime=null,this.endVal=this.validateValue(o),this.endVal!==this.frameVal&&(this.startVal=this.frameVal,this.finalEndVal==null&&this.resetDuration(),this.finalEndVal=null,this.determineDirectionAndSmartEasing(),this.rAF=requestAnimationFrame(this.count))},u.prototype.printValue=function(o){var l;if(this.el){var n=this.formattingFn(o);!((l=this.options.plugin)===null||l===void 0)&&l.render?this.options.plugin.render(this.el,n):this.el.tagName==="INPUT"?this.el.value=n:this.el.tagName==="text"||this.el.tagName==="tspan"?this.el.textContent=n:this.el.innerHTML=n}},u.prototype.ensureNumber=function(o){return typeof o=="number"&&!isNaN(o)},u.prototype.validateValue=function(o){var l=Number(o);return this.ensureNumber(l)?l:(this.error="[CountUp] invalid start or end value: ".concat(o),null)},u.prototype.resetDuration=function(){this.startTime=null,this.duration=1e3*Number(this.options.duration),this.remaining=this.duration},u}();const Gt="/userApi/";function Rt(){return at(),yt({url:Gt+"dashboard",method:"get"})}const w=u=>(Ut("data-v-e5e15578"),u=u(),qt(),u),Wt={class:"default-main",id:"div2"},Xt={id:"div1"},$t={class:"banner"},Qt={class:"welcome suspension",style:{height:"100px","justify-content":"center","align-items":"center"}},Jt={class:"welcome-text"},Kt={class:"welcome-note",style:{"font-size":"50px"}},Zt={class:"small-panel-box"},te={class:"small-panel suspension",style:{display:"flex"}},ee={style:{"text-align":"center",width:"20%"}},ae={style:{color:"#92969a","font-size":"15px",width:"100px"}},se={style:{"margin-top":"20px","font-size":"30px",color:"#000000",width:"70px"}},ne={id:"all_asset"},oe=w(()=>a("br",null,null,-1)),ie={id:"all_asset",style:{color:"#99FFFF","font-size":"20px"}},le=w(()=>a("span",{style:{color:"#FF0000","font-size":"20px"}},"/",-1)),re={id:"all_asset",style:{color:"#aaaaaa","font-size":"20px"}},de=w(()=>a("div",null,[a("div",{id:"all_asset_view",style:{height:"150px",width:"280px","margin-right":"20px"}})],-1)),ce={class:"small-panel suspension",style:{display:"flex"}},ue={style:{"text-align":"center"}},pe={style:{color:"#92969a","font-size":"15px",width:"100px"}},he={style:{"margin-top":"20px","font-size":"30px",color:"#000000",width:"70px"}},me={id:"all_asset"},fe=w(()=>a("br",null,null,-1)),_e={id:"all_asset",style:{color:"#99FFFF","font-size":"20px"}},ge=w(()=>a("span",{style:{color:"#FF0000","font-size":"20px"}},"/",-1)),ve={id:"all_asset",style:{color:"#aaaaaa","font-size":"20px"}},ye=w(()=>a("div",{style:{"text-align":"center"}},[a("div",{id:"all_beacon_view",style:{height:"150px",width:"300px","margin-left":"0px"}})],-1)),we={class:"small-panel suspension",style:{display:"flex"}},xe={style:{"text-align":"center"}},be={style:{color:"#92969a","font-size":"15px",width:"130px"}},Fe={style:{"margin-top":"20px","font-size":"30px",color:"#000000",width:"70px"}},Ve={id:"all_asset"},Se=w(()=>a("br",null,null,-1)),Ee={id:"all_asset",style:{color:"#99FFFF","font-size":"20px"}},De=w(()=>a("span",{style:{color:"#FF0000","font-size":"20px"}},"/",-1)),Ae={id:"all_asset",style:{color:"#aaaaaa","font-size":"20px"}},Ie=w(()=>a("div",{style:{"text-align":"center"}},[a("div",{id:"all_gateway_view",style:{height:"150px",width:"300px","margin-right":"0px"}})],-1)),ze={class:"growth-chart"},Oe=w(()=>a("div",{id:"dom_sos",class:"file-growth-chart"},null,-1)),ke=w(()=>a("div",{id:"dom_map",class:"file-growth-chart"},null,-1)),Ce={style:{height:"100px",width:"auto","justify-content":"center",display:"flex","align-items":"center"},class:"small-panel suspension"},Be={style:{"font-size":"25px",color:"#00aaff"}},Te=w(()=>a("br",null,null,-1)),Ne=w(()=>a("br",null,null,-1)),Le={style:{"font-size":"30px",color:"#00aaff"}},Me=["id"],Ye=kt({name:"dashboard",__name:"dashboard111",setup(u){let o=f(""),l=f("");const{t:n}=wt(),e=xt();at(),bt();let h=f(0);const m=Ct({charts:[],remark:"dashboard.Loading",workingTimeFormat:"",pauseWork:!1});Rt().then(t=>{m.remark=t.data.remark});const p=t=>{et(()=>{var s;let i=(s=document.getElementById(t))==null?void 0:s.innerText;i&&new jt(t,parseInt(i),{startVal:0,duration:3}).start()})},F=()=>{p("all_asset"),p("user_reg_number"),p("file_number"),p("users_number"),p("addons_number")},x=()=>{et(()=>{for(const t in m.charts)m.charts[t].resize()})};Bt(()=>{x(),console.log("reg onDeactivated,每次离开都执行一下aaaaaaaaaaaa"),ot(),J=setInterval(nt,1e3)}),Tt(()=>{console.log("reg onDeactivated,每次离开都执行一下"),clearInterval(Y),clearInterval(J)}),ht([mt,ft,_t,gt,vt]);var M,A,O,I,V,z,E,U,q,j,k,C,S,B,T;S={tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"value"},yAxis:{type:"category",data:["地图1","地图5"]},series:[{color:"#99FFaa",name:n("online"),type:"bar",stack:"total",label:{show:!0},emphasis:{focus:"series"},data:[120,210]},{color:"#aaaaaa",name:n("unline"),type:"bar",stack:"total",label:{show:!0},emphasis:{focus:"series"},data:[10,20]}]};let G=f(0),R=f(0);k={color:["#99FFFF","#aaaaaa"],title:{text:"",subtext:"",left:"center"},emphasis:{label:{show:!0,fontSize:10,fontWeight:"bold"}},tooltip:{trigger:"item"},legend:{orient:"vertical",left:"right",show:!1},series:[{name:K.global.t("device_status"),type:"pie",radius:"60%",data:[{value:0,name:n("online")},{value:0,name:n("unline")}],emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]};let W=f(0),X=f(0);C={color:["#99FFaa","#aaaaaa"],title:{text:"",subtext:"",left:"center"},emphasis:{label:{show:!0,fontSize:10,fontWeight:"bold"}},tooltip:{trigger:"item"},legend:{orient:"vertical",left:"right",show:!1},series:[{name:K.global.t("Locator_status"),type:"pie",radius:"60%",data:[{value:31,name:n("online")},{value:10,name:n("unline")}],emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]};let $=f(0),Q=f(0);B={color:["#77ddff","#aaaaaa"],title:{text:"",subtext:"",left:"center"},emphasis:{label:{show:!0,fontSize:10,fontWeight:"bold"}},tooltip:{trigger:"item"},legend:{orient:"vertical",left:"right",show:!1},series:[{name:K.global.t("beacon_status"),type:"pie",radius:"60%",data:[{value:0,name:n("online")},{value:0,name:n("unline")}],emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]},T={legend:void 0,tooltip:void 0,xAxis:{type:"category",data:[n("disassemble"),n("move"),n("unline1"),n("outto"),n("into"),n("bt_sos")]},yAxis:{type:"value"},series:[{data:[5,5,5,5,5,5],type:"bar"}]},Nt(()=>{F(),Ft(window,"resize",x),M=document.getElementById("all_asset_view"),z=L(M),k&&z.setOption(k,!0),O=document.getElementById("all_beacon_view"),U=L(O),B&&U.setOption(B,!0),A=document.getElementById("all_gateway_view"),E=L(A),C&&E.setOption(C,!0),I=document.getElementById("dom_sos"),q=L(I),T&&q.setOption(T,!0),V=document.getElementById("dom_map"),j=L(V),S&&j.setOption(S,!0);var t=document.getElementById("div1");console.log(t==null?void 0:t.offsetHeight),h.value=(t==null?void 0:t.offsetHeight)-100}),Lt(()=>{console.log("注销"+Y),clearInterval(Y),clearInterval(J)});function st(t,i){console.log(i),console.log("DDD="+t);var s=N.value[t-1];if(console.log(s),s!=null){var r,c=s.alarm_type;c=="sos_offline"?r='<span style="color: #000000">'+s.name+"-"+s.sn+'：</span><span style="color: #aaaaaa">'+n("sos_offline")+'</span><span style="margin-left: 20px">'+D(s.create_time)+"</span>":c=="sos_online"?r='<span style="color: #000000">'+s.name+"-"+s.sn+'：</span><span style="color: #00FF00">'+n("sos_online")+'</span><span style="margin-left: 20px">'+D(s.create_time)+"</span>":c=="sos_key"?r='<span style="color: #000000">'+s.name+"-"+s.sn+'：</span><span style="color: #FF0000">'+n("disassemble1")+'</span><span style="margin-left: 20px">'+D(s.create_time)+"</span>":c=="sos_run"?r='<span style="color: #000000">'+s.name+"-"+s.sn+'：</span><span style="color: #FF0000">'+n("sos_run")+'</span><span style="margin-left: 20px">'+D(s.create_time)+"</span>":c=="sos_bt"?r='<span style="color: #000000">'+s.name+"-"+s.sn+'：</span><span style="color: #FF0000">'+n("sos_bt")+'</span><span style="margin-left: 20px">'+D(s.create_time)+"</span>":c=="fence_out_sos"?r='<span style="color: #000000">'+s.name+"-"+s.sn+'：</span><span style="color: #FF0000">'+n("fence_out_sos")+'</span><span style="margin-left: 20px">'+D(s.create_time)+"</span>":c=="fence_on_sos"&&(r='<span style="color: #000000">'+s.name+"-"+s.sn+'：</span><span style="color: #FF0000">'+n("fence_on_sos")+'</span><span style="margin-left: 20px">'+D(s.create_time)+"</span>");var y=document.getElementById("item"+t);y!=null&&(y.innerHTML=r)}}function D(t){return t==null?"":(console.log("时间戳="+t),Ot(t*1e3).format("YYYY-MM-DD HH:mm:ss"))}function nt(){let t=new Date,i=t.getFullYear(),s=t.getMonth()+1,r=t.getDate(),c=t.getHours(),y=t.getMinutes(),b=t.getSeconds();o.value=i+"-"+s+"-"+r,c<10?l.value="0"+c+":":l.value=c+":",y<10?l.value=l.value+"0"+y+":":l.value=l.value+y+":",b<10?l.value=l.value+"0"+b:l.value=l.value+b}var Y,J;let N=f([]);function ot(){Y=setInterval(function(){St().then(t=>{if(t.code==1&&t.data!=null){R.value=t.data.offline_sum,G.value=t.data.online_sum;const i=[],s={value:t.data.offline_sum,name:n("unline")},r={value:t.data.online_sum,name:n("online")};i.push(r),i.push(s),k.series[0].data=i,z.setOption(k)}}),Et().then(t=>{if(t.code==1&&t.data!=null){Q.value=t.data.offline_sum,$.value=t.data.online_sum;const i=[],s={value:t.data.offline_sum,name:n("unline")},r={value:t.data.online_sum,name:n("online")};i.push(r),i.push(s),B.series[0].data=i,U.setOption(B)}}),Dt().then(t=>{if(t.code==1&&t.data!=null){X.value=t.data.offline_sum,W.value=t.data.online_sum;const i=[],s={value:t.data.offline_sum,name:n("unline")},r={value:t.data.online_sum,name:n("online")};i.push(r),i.push(s),C.series[0].data=i,E.setOption(C)}}),At().then(t=>{if(t.code==1&&t.data!=null){f(0),f(0),f(0),f(0),f(0),f(0);const i=[],s={color:"#FF0000"},r={value:t.data.key_sum,itemStyle:s},c={color:"#ffaadd"},y={value:t.data.run_sum,itemStyle:c},b={color:"#aaaaaa"},it={value:t.data.offline_sum,itemStyle:b},lt={color:"#FF0000"},rt={value:t.data.fence_out_sum,itemStyle:lt},dt={color:"#00ffff"},ct={value:t.data.fence_on_sum,itemStyle:dt},ut={color:"#aaaaaa"},pt={value:t.data.bt_sum,itemStyle:ut};i.push(r),i.push(y),i.push(it),i.push(rt),i.push(ct),i.push(pt),T.series[0].data=i,q.setOption(T)}}),It().then(t=>{if(t.code==1){for(var i=[],s=[],r=[],c=0;c<t.data.length;c++){var y=t.data[c];i.push(y.name),s.push(y.on),r.push(y.off)}S.yAxis.data=i,S.series[0].data=s,S.series[1].data=r,S&&j.setOption(S)}}),zt().then(t=>{if(t.code==1){N.value=[],console.log(t.data),console.log(N.value.length);for(var i=0;i<t.data.length;i++){var s=t.data[i];N.value.push(s)}}})},3e3)}return Mt(()=>{for(const t in m.charts)m.charts[t].dispose()}),Yt(()=>e.state.tabFullScreen,()=>{x()}),(t,i)=>{const s=H("el-col"),r=H("el-row"),c=H("el-card"),y=H("el-scrollbar");return Z(),tt("div",Wt,[g(r,{gutter:20},{default:v(()=>[g(s,{span:18},{default:v(()=>[a("div",Xt,[a("div",$t,[g(r,{gutter:10},{default:v(()=>[g(s,{md:24},{default:v(()=>[a("div",Qt,[a("div",Jt,[a("div",Kt,_(d(n)("Asset management platform")),1)])])]),_:1})]),_:1})]),a("div",Zt,[g(r,{gutter:20},{default:v(()=>[g(s,{span:8},{default:v(()=>[a("div",te,[a("div",ee,[a("div",ae,[a("span",null,_(d(n)("device_status")),1)]),a("div",se,[a("span",ne,_(d(R)+d(G)),1),oe,a("span",ie,_(d(G)),1),le,a("span",re,_(d(R)),1)])]),de])]),_:1}),g(s,{span:8},{default:v(()=>[a("div",ce,[a("div",ue,[a("div",pe,[a("span",null,_(d(n)("beacon_status")),1)]),a("div",he,[a("span",me,_(d(Q)+d($)),1),fe,a("span",_e,_(d($)),1),ge,a("span",ve,_(d(Q)),1)])]),ye])]),_:1}),g(s,{span:8},{default:v(()=>[a("div",we,[a("div",xe,[a("div",be,[a("span",null,_(d(n)("Locator_status")),1)]),a("div",Fe,[a("span",Ve,_(d(X)+d(W)),1),Se,a("span",Ee,_(d(W)),1),De,a("span",Ae,_(d(X)),1)])]),Ie])]),_:1})]),_:1})]),a("div",ze,[g(r,{gutter:10},{default:v(()=>[g(s,{class:"lg-mb-20",span:12},{default:v(()=>[g(c,{shadow:"hover",header:d(n)("Alarm Log")},{default:v(()=>[Oe]),_:1},8,["header"])]),_:1}),g(s,{class:"lg-mb-20",span:12},{default:v(()=>[g(c,{shadow:"hover",header:d(n)("Asset Allocation")},{default:v(()=>[ke]),_:1},8,["header"])]),_:1})]),_:1})])])]),_:1}),g(s,{span:6},{default:v(()=>[a("div",Ce,[a("div",null,[a("span",Be,_(d(o)),1),Te,Ne,a("span",Le,_(d(l)),1)])]),a("div",null,[g(y,{height:d(h)},{default:v(()=>[(Z(!0),tt(Ht,null,Pt(d(N).length,b=>(Z(),tt("p",{id:"item"+b,key:b,class:"suspension",style:{float:"left",color:"#00aaff","background-color":"#ffffff",width:"100%","border-radius":"var(--el-border-radius-base)",padding:"15px","margin-bottom":"10px"}},_(st(b,this)),9,Me))),128))]),_:1},8,["height"])])]),_:1})]),_:1})])}}});const Ge=Vt(Ye,[["__scopeId","data-v-e5e15578"]]);export{Ge as default};
