import{S as X,$ as d}from"./sass.default-e4c9116c.js";import{m as E}from"./map-a5492c66.js";var y;let s=!1;var v=!0,e=[],A=[],u=[],b=0,F=0;let g=!1;var c;function O(){g=!0}function B(){g=!1}function I(){e=[],s=!1,v=!0}function j(o,l){y=X("#svgPanel"),e=[],s=!1,v=!0;var f=0;E(),S()&&(f=1),d("#svgPanel").on("click",function(n){if(g){if(s){s=!1;return}if(v&&!(b==n.offsetX&&F==n.offsetY)&&(b=n.offsetX,F=n.offsetY,e.push(p(n.offsetX,n.offsetY,f)),e.length>0)){for(var r="",t=0;t<e.length;t++)r=r+e[t].x+","+e[t].y+" ";console.log("折线="+r),x(r,u.length)}}}).on("mousemove",function(n){if(g){var r=p(n.offsetX,n.offsetY,f);c&&c.remove(),c=y.circle(2).fill("#0af").move(r.x,r.y)}if(e.length>0&&v&&!s){for(var t="",a=0;a<e.length;a++)t=t+e[a].x+","+e[a].y+" ";var i=p(n.offsetX,n.offsetY,f);t=t+i.x+","+i.y,x(t,u.length)}}).on("dblclick",function(n){if(g&&e.length>3){console.log(s),s=!0,e[0];for(var r="",t=0;t<e.length;t++)r=r+e[t].x+","+e[t].y+" ";r=r+e[0].x+","+e[0].y,e.push({x:e[0].x,y:e[0].y}),x(r,u.length);var a=y.polygon(r);a.opacity(.2),a.fill("#0aa"),A.push(a),v=!1,c&&c.remove(),u.push(e),o(r,u,e,l,"add",0,"")}})}function w(o,l){this.x=o,this.y=l}w.prototype.toString=function(){return this==null?"null":'{"x": '+this.x+', "y": '+this.y+"}"};function p(o,l,f){d("li.building-on");var n=0,r=0,t="",a="",i="",P=document.getElementById("svgPanel"),h=P.getAttribute("transform");if(h.indexOf(",")<0){var m=h.split(" ");h=m[0]+","+m[1]+" "+m[2]}return i=h.split(" "),t=i[0].substring(10,i[0].length-1).split(","),i.length==3?a=parseFloat(i[2].substring(6,i[2].length-1)):i.length==2&&(a=parseFloat(i[1].substring(6,i[1].length-1))),n=parseFloat(t[0]),r=parseFloat(t[1]),f==1?new w((o/a).toFixed(2),(l/a).toFixed(2)):new w(((o-n)/a).toFixed(2),((l-r)/a).toFixed(2))}function x(o,l){var f=document.getElementById("polyline"+l);if(f){var t="polyline"+l;d("#"+t).attr("points",o)}else{var n=document.createElementNS("http://www.w3.org/2000/svg","polyline"),r=document.getElementById("svgPanel");n.setAttribute("id","polyline"+l),n.setAttribute("points",o),n.setAttribute("style","fill:none;stroke:red;stroke-width:"+.5),r.appendChild(n)}}function D(){var o=0;u.forEach(function(l){var f="polyline"+o;d("#"+f).remove(),o++}),A.forEach(function(l){l.remove()}),u=[],s=!1,v=!0}function S(){var o=navigator.userAgent;return window.ActiveXObject||"ActiveXObject"in window?!0:(o.indexOf("Firefox")>-1,!1)}export{O as a,D as c,I as d,j as i,B as s};
