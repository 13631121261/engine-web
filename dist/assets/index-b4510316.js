import{C as ee,d as te,b as ae,T as le}from"./index-11ae6512.js";import{c as Q,_ as Z,a as oe,$ as ne}from"./index-1515df1a.js";import{h as J,ar as se,w as _,r as re,j as z,q as h,a8 as ie,o as f,k as V,p as d,Q as c,a9 as E,at as de,Y as q,as as U,af as ue,z as n,ag as pe,m as H,P as T,a7 as F,X as N,Z as R,V as I,ai as ce,K as O,aw as me,F as fe,a0 as _e,a1 as be}from"./vue-974988d6.js";import{S as ye,k as ve}from"./index-24a0fd9a.js";import{l as he,c as G,a as ge,d as xe,b as j,e as K}from"./map-a5492c66.js";import"./index-7182f49c.js";import"./sass.default-e4c9116c.js";import"./moment-fbc5633a.js";const ke={style:{"margin-left":"10px"}},we={class:"table-header-operate-text"},Se=J({__name:"index_history",props:{buttons:{default:()=>["refresh","add","edit","delete"]},quickSearchPlaceholder:{default:""}},setup(k){const w=k,{t:l}=Q(),t=se("baTable"),g=_(!1),i=re({quickSearch:"",history_type:"",start_time:0,stop_time:0}),C=s=>{if(i.history_type==""){O({title:l("Reminder"),message:l("history_type_tip"),position:"bottom-right",type:"error",duration:3e3,dangerouslyUseHTMLString:!0});return}g.value=!0,ye(s,i.history_type).then(o=>{g.value=!1,b.value=[];for(var u=0;u<o.data.length;u++)if(i.history_type=="person"){var y={label:o.data[u].name,value:o.data[u].idcard};b.value.push(y)}else if(i.history_type=="device"){var y={label:o.data[u].name,value:o.data[u].sn};b.value.push(y)}})},A=s=>{console.log(s),i.history_type=s,i.quickSearch="",b.value=[]},$=s=>{console.log(s[0]),console.log(s[1]);const o=new Date(s[0]),u=new Date(s[1]);i.start_time=o.getTime()/1e3,i.stop_time=u.getTime()/1e3};_("");const D=[{value:"device",label:l("device")},{value:"person",label:l("person1")}];let b=_([]);z(()=>{let s=[];for(let o of t.table.column)o.type==="selection"||o.render==="buttons"||o.enableColumnDisplayControl===!1||s.push(o);return s}),z(()=>t.table.selection.length>0);const L=(s,o={})=>{t.onTableHeaderAction(s,o)},e=()=>{if(i.start_time==0){O({title:l("Reminder"),message:l("history_tip"),position:"bottom-right",type:"error",duration:3e3,dangerouslyUseHTMLString:!0});return}if(i.history_type==""){O({title:l("Reminder"),message:l("history_type_tip"),position:"bottom-right",type:"error",duration:3e3,dangerouslyUseHTMLString:!0});return}t.onTableHeaderAction("history",i)},x=_(""),P=new Date(2e3,1,1,12,0,0);return(s,o)=>{const u=h("Icon"),y=h("el-button"),B=h("el-tooltip"),X=h("el-date-picker"),S=h("el-option"),M=h("el-select"),r=ie("blur");return f(),V(N,null,[d(pe,{name:"el-zoom-in-bottom",mode:"out-in"},{default:c(()=>[E(d(ee,null,de({_:2},[q(s.$slots,(a,p)=>({name:p,fn:c(()=>[U(s.$slots,p,{},void 0,!0)])}))]),1536),[[ue,w.buttons.includes("comSearch")&&n(t).table.showComSearch]])]),_:3}),H("div",ce(s.$attrs,{class:"table-header ba-scroll-style"}),[U(s.$slots,"refreshPrepend",{},void 0,!0),w.buttons.includes("refresh")?(f(),T(B,{key:0,content:n(l)("Refresh"),placement:"top"},{default:c(()=>[E((f(),T(y,{onClick:o[0]||(o[0]=a=>L("refresh",{loading:!0})),color:"#40485b",class:"table-header-operate",type:"info"},{default:c(()=>[d(u,{name:"fa fa-refresh"})]),_:1})),[[r]])]),_:1},8,["content"])):F("",!0),U(s.$slots,"refreshAppend",{},void 0,!0),H("div",ke,[d(X,{"value-format":"YYYY-MM-DD HH:mm:ss",modelValue:x.value,"onUpdate:modelValue":o[1]||(o[1]=a=>x.value=a),type:"datetimerange","start-placeholder":n(l)("fence_starttime"),"end-placeholder":n(l)("fence_stoptime"),"default-time":n(P),onChange:$},null,8,["modelValue","start-placeholder","end-placeholder","default-time"])]),d(M,{modelValue:i.history_type,"onUpdate:modelValue":o[2]||(o[2]=a=>i.history_type=a),placeholder:n(l)("history_type"),style:{"margin-left":"10px",width:"200px"},onChange:A},{default:c(()=>[(f(),V(N,null,q(D,a=>d(S,{key:a.value,label:a.label,value:a.value},null,8,["label","value"])),64))]),_:1},8,["modelValue","placeholder"]),d(M,{modelValue:i.quickSearch,"onUpdate:modelValue":o[3]||(o[3]=a=>i.quickSearch=a),filterable:"",remote:"","reserve-keyword":"",placeholder:n(l)("select_tip"),"remote-show-suffix":"","remote-method":C,loading:g.value,style:{width:"200px","margin-left":"10px"}},{default:c(()=>[(f(!0),V(N,null,q(n(b),a=>(f(),T(S,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder","loading"]),d(y,{type:"primary",style:{"margin-left":"10px"},onClick:e},{default:c(()=>[R(I(n(l)("Search")),1)]),_:1}),w.buttons.includes("unfold")?(f(),T(B,{key:1,content:(n(t).table.expandAll?n(l)("Shrink"):n(l)("Open"))+n(l)("All submenus"),placement:"top"},{default:c(()=>[E((f(),T(y,{onClick:o[4]||(o[4]=a=>n(t).onTableHeaderAction("unfold",{unfold:!n(t).table.expandAll})),class:"table-header-operate",type:n(t).table.expandAll?"danger":"warning"},{default:c(()=>[H("span",we,I(n(t).table.expandAll?n(l)("Shrink all"):n(l)("Expand all")),1)]),_:1},8,["type"])),[[r]])]),_:1},8,["content"])):F("",!0),U(s.$slots,"default",{},void 0,!0)],16)],64)}}});const Te=Z(Se,[["__scopeId","data-v-030bf309"]]),Ve=k=>(_e("data-v-c913b93f"),k=k(),be(),k),Ce={class:"default-main ba-table-box"},Ae=Ve(()=>H("div",{id:"main",class:"hdmrboxtm-mbox",viewBox:"0 0 0 0"},null,-1)),$e={key:0,class:"bottom"},He=J({name:"auth/group",__name:"index",setup(k){_();const w=_(),{t:l}=Q();oe();var t;let g=te(["delete"]),i=[{render:"tipButton",name:"info",title:"look",type:"success",icon:"fa fa-play",class:"table-row-info",disabledTip:!1,click:(r,a)=>{},display:(r,a)=>!0,disabled:(r,a)=>!1,attr:{color:"#0AFF85"}}];g=g.concat(i),g[1].click=(r,a)=>{console.log("点击了按钮"+r),t=r.list,A.value=!1,$.value=!0,e=0,b.value=e,he(r.map_data),G(),ve(r.map_key).then(p=>{if(p.data.length>0)for(var m=0;m<p.data.length;m++){const Y={address:p.data[m].address,name:p.data[m].name,x:p.data[m].x,y:p.data[m].y,proportion:10,show:!1,online:p.data[m].online,last_time:p.data[m].last_time,type:2};ge(Y)}})};const C=new ae(new ne("/userApi/History/"),{dblClickNotEditColumn:["all"],column:[{type:"selection",align:"center"},{label:l("id"),prop:"id",align:"center"},{label:l("device_person_name"),prop:"name",align:"center"},{label:l("sn_idcard"),prop:"sn",align:"center",render:"tag"},{label:l("map_name"),prop:"map_name",align:"center",render:"tag"},{label:l("fence_starttime"),render:"datetime",prop:"start_time",align:"center"},{label:l("fence_stoptime"),render:"datetime",prop:"stop_time",align:"center"},{label:l("history_sum_tip"),prop:"sum",align:"center"},{label:l("Operate"),align:"center",width:"180",render:"buttons",buttons:g,fixed:"right"}]},{defaultItems:{status:"1"}});let A=_(!0),$=_(!1);const D=_(""),b=_(0),L=[{value:"1",label:"1X"},{value:"3",label:"3X"},{value:"5",label:"5X"},{value:"10",label:"10X"}];me("baTable",C),fe(()=>{C.table.ref=w.value,C.mount()});var e=0,x=1e3;function P(){s.value=!0,o=!1,y()}let s=_(!1);var o=!1,u=1;function y(){if(o==!0){console.log("停止了");return}let r=setTimeout(()=>{e<0&&(e=0),e<t.length-1?(console.log("index="+e+" 长度="+t.length),x=(t[e+1].time-t[e].time)/u,console.log("延时=="+x),xe(t[e].time,t[e].x*10,t[e].y*10,t[e+1].x*10,t[e+1].y*10,x),b.value=e,e==0&&j(t[e].time,t[e].x*10,t[e].y*10),e++):(console.log("88888888888index="+e+" 长度="+t.length),console.log("杀掉定时"),o=!0),clearTimeout(r),y()},x)}const B=r=>{S();var a=r;if(e<0&&(e=0),a>e){for(;e<a;e++){if(console.log(e),e>t.length-2){console.log("kkkkkkk"+e);return}e==0&&j(t[e].time,t[e].x*10,t[e].y*10),K(t[e].time,t[e].x*10,t[e].y*10,t[e+1].x*10,t[e+1].y*10,e)}e--}else{for(;a<=e;e--)e==0&&j(t[e].time,t[e].x*10,t[e].y*10),e>=t.length-1&&e--,K(t[e].time,t[e].x*10,t[e].y*10,t[e+1].x*10,t[e+1].y*10,e);e<0&&(e=0)}},X=r=>{u=r,console.log(r)};function S(){s.value=!1,o=!0}function M(){S(),A.value=!0,$.value=!1,G()}return(r,a)=>{const p=h("el-slider"),m=h("el-button"),Y=h("el-option"),W=h("el-select");return f(),V("div",Ce,[d(Te),n(A)?(f(),T(le,{key:0,ref_key:"tableRef",ref:w,style:{width:"20px"}},null,512)):F("",!0),H("div",null,[Ae,n($)?(f(),V("div",$e,[d(p,{modelValue:b.value,"onUpdate:modelValue":a[0]||(a[0]=v=>b.value=v),onInput:B,max:n(t).length-1},null,8,["modelValue","max"]),d(m,{onClick:a[1]||(a[1]=v=>P()),disabled:n(s),type:"primary"},{default:c(()=>[R(I(n(l)("play")),1)]),_:1},8,["disabled"]),d(m,{onClick:a[2]||(a[2]=v=>S()),disabled:!n(s),type:"warning"},{default:c(()=>[R(I(n(l)("stop")),1)]),_:1},8,["disabled"]),d(W,{modelValue:D.value,"onUpdate:modelValue":a[3]||(a[3]=v=>D.value=v),class:"m-2",placeholder:"Select",style:{width:"100px","margin-left":"10px"},onChange:X},{default:c(()=>[(f(),V(N,null,q(L,v=>d(Y,{key:v.value,label:v.label,value:v.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),d(m,{style:{"margin-left":"10px"},onClick:a[4]||(a[4]=v=>M()),type:"danger"},{default:c(()=>[R(I(n(l)("out")),1)]),_:1})])):F("",!0)])])}}});const Fe=Z(He,[["__scopeId","data-v-c913b93f"]]);export{Fe as default};
