import{h as W,w as h,ar as E,r as w,q as u,a8 as b,o as m,P as p,Q as s,a9 as v,k as H,Z as f,V as c,z as o,m as k,l as D,p as i,a3 as L,$ as M,a7 as C,K as T}from"./vue-974988d6.js";import{a as O,c as Q,_ as Z}from"./index-1515df1a.js";import{b as d}from"./validate-8bf15b2e.js";import{F as g}from"./index-a773531e.js";import{j as G,o as J}from"./index-24a0fd9a.js";import"./index-11ae6512.js";import"./index-7182f49c.js";const X={class:"title"},Y={style:{"margin-left":"5px"}},ee=W({__name:"outPut",setup(oe){O(),h();const r=E("baTable"),{t}=Q(),S=w({code_name:[d({name:"required",title:t("type_name")})],price:[d({name:"required",title:t("unit-price")}),d({name:"price"})],notes:[d({name:"required",title:t("notes")})],batch:[d({name:"required",title:t("batch")}),d({name:"id"})],sn:[d({name:"required",title:t("code_sn")})],code_sn:[d({name:"required",title:t("code_sn")})]});function B(){G(e.code_sn).then(n=>{n.code==1&&(e.sn=n.sn),console.log(n)})}const x=h(),e=w({project_key:"",user_key:"",notes:"",out_sum:0,code_sn:"",code_name:"",barn_name:"",batch:-1,surplus:1,unit:"台",barnType:"Normal",idcard:"",type_id:0,sn:"",max:500});function N(){var n;(n=x.value)==null||n.validate(l=>{if(console.log("000"),l){if(e.out_sum>e.surplus||e.out_sum>e.max){T({title:t("State"),message:t("cdcd"),type:"error",duration:1e3,dangerouslyUseHTMLString:!0});return}J(e).then(_=>{_.code==1&&(T({message:_.msg,type:"success"}),r.onTableHeaderAction("refresh",{}),r.form.operate="")})}})}function U(){e.sn="",e.code_sn=r.form.items.code_sn,e.code_name=r.form.items.name,e.batch=-1,e.barn_name="",console.log("打开"+r.form.items.name),console.log(e),e.surplus=1,e.out_sum=0,e.barnType="Normal",e.notes="",e.type_id=r.form.items.type_id}const q=n=>{console.log(n),e.unit=n.unit,e.sn="",e.max=n.stock,e.surplus=n.stock},A=n=>{console.log(e.out_sum),console.log(n),n=="Check"||n=="Destruction"?(e.max=e.surplus,e.sn=""):(e.max=1,e.sn="",e.out_sum=1)};return(n,l)=>{const _=u("el-input"),y=u("el-form-item"),F=u("el-input-number"),V=u("el-button"),z=u("el-form"),P=u("el-scrollbar"),$=u("el-dialog"),I=b("drag"),j=b("zoom"),K=b("loading"),R=b("blur");return m(),p($,{class:"ba-operate-dialog","close-on-click-modal":!1,"model-value":["Add"].includes(o(r).form.operate),onClose:o(r).toggleForm,"destroy-on-close":!0,open:U()},{header:s(()=>[v((m(),H("div",X,[f(c(o(t)("outBran")),1)])),[[I,[".ba-operate-dialog",".el-dialog__header"]],[j,".ba-operate-dialog"]])]),footer:s(()=>[k("div",{style:D("width: calc(100% - "+o(r).form.labelWidth/1.8+"px)")},[i(V,{onClick:l[9]||(l[9]=a=>o(r).toggleForm(""))},{default:s(()=>[f(c(o(t)("Cancel")),1)]),_:1}),v((m(),p(V,{loading:o(r).form.submitLoading,onClick:l[10]||(l[10]=a=>N()),type:"primary"},{default:s(()=>[f(c(o(t)("Save")),1)]),_:1},8,["loading"])),[[R]])],4)]),default:s(()=>[v((m(),p(P,{class:"ba-table-form-scrollbar"},{default:s(()=>[k("div",{class:L(["ba-operate-form","ba-"+o(r).form.operate+"-form"]),style:D("width: calc(100% - "+o(r).form.labelWidth/2+"px)")},[o(r).form.loading?C("",!0):(m(),p(z,{key:0,ref_key:"ruleFormRef",ref:x,onKeyup:l[8]||(l[8]=M(a=>n.addDeviceBarn1(),["enter"])),model:e,"label-position":"right","label-width":o(r).form.labelWidth+"px",rules:S},{default:s(()=>[i(g,{prop:"code_sn",label:o(t)("device_code_name"),type:"remoteSelect",modelValue:e.code_sn,"onUpdate:modelValue":l[0]||(l[0]=a=>e.code_sn=a),"input-attr":{multiple:!1,pk:"code_sn",field:"name","remote-url":"/userApi/DeviceCode/index1",render:"datetime",onRow:q},placeholder:o(t)("device_code_name")},null,8,["label","modelValue","input-attr","placeholder"]),i(y,{label:o(t)("stock")},{default:s(()=>[i(_,{modelValue:e.surplus,"onUpdate:modelValue":l[1]||(l[1]=a=>e.surplus=a),disabled:""},{append:s(()=>[f(c(e.unit),1)]),_:1},8,["modelValue"])]),_:1},8,["label"]),i(g,{label:o(t)("out_type"),type:"radio",modelValue:e.barnType,"onUpdate:modelValue":l[2]||(l[2]=a=>e.barnType=a),"input-attr":{size:"small",onChange:A},data:{childrenAttr:{border:!0},content:{Consuming:o(t)("Consuming"),Destruction:o(t)("Destruction"),Check:o(t)("inventory check")}}},null,8,["label","modelValue","input-attr","data"]),i(y,{label:o(t)("out_sum")},{default:s(()=>[i(F,{modelValue:e.out_sum,"onUpdate:modelValue":l[3]||(l[3]=a=>e.out_sum=a),min:1,max:e.max},null,8,["modelValue","max"]),k("span",Y,c("  "+e.unit),1)]),_:1},8,["label"]),["Normal","Consuming"].includes(e.barnType)?(m(),p(y,{key:0,prop:"sn",label:o(t)("code_sn")},{default:s(()=>[i(_,{modelValue:e.sn,"onUpdate:modelValue":l[4]||(l[4]=a=>e.sn=a),placeholder:o(t)("create_sn"),clearable:""},null,8,["modelValue","placeholder"]),i(V,{style:{"margin-top":"5px"},type:"info",onClick:l[5]||(l[5]=a=>B())},{default:s(()=>[f(c(o(t)("Autogenerate")),1)]),_:1})]),_:1},8,["label"])):C("",!0),e.barnType=="Consuming"?(m(),p(g,{key:1,label:o(t)("Consuming_who"),type:"remoteSelect",modelValue:e.idcard,"onUpdate:modelValue":l[6]||(l[6]=a=>e.idcard=a),"input-attr":{multiple:!1,pk:"idcard",field:"name","remote-url":"/userApi/Person/index1",tooltipParams:{部门:"department_name"}},placeholder:o(t)("Consuming_who")},null,8,["label","modelValue","placeholder"])):C("",!0),i(g,{label:o(t)("notes"),modelValue:e.notes,"onUpdate:modelValue":l[7]||(l[7]=a=>e.notes=a),type:"string",placeholder:o(t)("notes"),"input-attr":{clearable:!0}},null,8,["label","modelValue","placeholder"])]),_:1},8,["model","label-width","rules"]))],6)]),_:1})),[[K,o(r).form.loading]])]),_:1},8,["model-value","onClose","open"])}}});const de=Z(ee,[["__scopeId","data-v-820f82c2"]]);export{de as default};
